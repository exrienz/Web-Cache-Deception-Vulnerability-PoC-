## Evil Cache Deception PoC Exploit

This repository contains a proof-of-concept (PoC) exploit that demonstrates a cache-based attack targeting a specific website. The exploit is designed to manipulate the target user's browser cache and potentially retrieve sensitive information. Please note that this repository is for educational and ethical purposes only. Do not use this code maliciously or without proper authorization. 

P/S: The Web Cache Deception vulnerability allows attackers to retrieve any information stored in the application, including the CSRF token of trapped users. With the CSRF token being leaked, attackers will be able to force trapped users to do whatever is possible from their own session.

e.g.

````
<html>
  <body>
    <form action="https://example.com/approve_accounts" method="POST">
      <input type="hidden" name="filterBy" value="0" />
      <input type="hidden" name="&#95;editedPendingBuyerAccIds" value="on" />
      <input type="hidden" name="&#95;csrf" value="[CSRF-TOKEN-RETRIEVED]" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
  </body>
</html>
````


### Exploitation Requirement

1. Vulnerable apps running on CDN (A CDN, or Content Delivery Network, is a distributed network of servers strategically located across various geographical locations) for example Cloudflare etc.
2. Caching is enabled (on CDN)
3. Same site attribute was set to "none" (by default)

### Usage

Follow these steps to use the Evil Cache PoC Exploit:

1. **Modify the Code**: Open the `poc.html` file and modify the code to include the URL of your target site. Look for the variable named `link ` and replace its value with the URL of the target site you want to perform the cache-based attack on.

2. **Upload the Code**: Upload the modified `poc.html` file to your own web hosting or server. Once uploaded, note down the URL where the file is hosted. For example, `https://yourdomain.com/poc.html`.

3. **Send the Link**: Craft a convincing message and send the link to your victim. The link should direct them to open the exploit. For example: "Hey, check out this interesting page: [Click Here](https://yourdomain.com/poc.html)".

4. **Execute the Attack**: When the victim opens the provided link, the PoC will manipulate the browser's cache settings. Specifically, it will attempt to force the victim's browser to cache the webpage `/secure/view_profile`, which will be retrieved by the attacker.

5. **Retrieve the Path**: As an attacker, you can retrieve the manipulated path as follows: `/secure/view_profile;[id].jpg`. This is the path that the victim's browser has been manipulated to cache.

### Remediation

1. Disable caching for sensitive pages that involve user data and authentication tokens, including the CSRF token. Ensure that no sensitive information is cached.
2. Update the "SameSite" attribute for session cookies to enforce strict SameSite policies where appropriate. Setting "SameSite" to "Strict" or "Lax" can help prevent CSRF attacks. You have two main options, **"Strict":** Cookies will only be sent in requests initiated by the same site. This is the most secure option, but it might break certain cross-site functionality. **"Lax":** Cookies are sent in top-level navigations and in POST requests from other sites. This is a more lenient option that balances security with usability.


### Disclaimer

This PoC exploit is intended for educational and ethical purposes only. The use of this code for malicious purposes or without proper authorization is strictly prohibited. The author is not responsible for any misuse or damage caused by the exploitation of this code. Use at your own risk.

### Legal Notice

Please be aware that unauthorized access to computer systems, networks, or data is illegal in many jurisdictions. Make sure to obtain proper authorization before testing this PoC on any website or system you do not own or have explicit permission to test. Always adhere to applicable laws and regulations.

